
README for demo_module_1
********************************************************************

This code example shows you how to modify the code generated by 
"mib2c -c mib2c.scalar.conf" command to perform a scalar
data retrieval.  


Introduction
------------
This example shows you how to generate templates with mib2c from a sample 
MIB.  You can then compare these templates with the source code and header
files provided with the example. The source files were created by modifying
the templates that you create in this example. 

The example also shows you how to build a module from the modified source files. 

Files:

* Makefile - Compiles the module source code
* demo_module_1.c - Source code for the module, returns load averages
* demo_module_1.h - Header file for the module
* SDK-DEMO1-MIB.txt - MIB file used in the module




How to Use the demo_module_1 Code Example
==========================================


To set up your environment for the demo:

1. Copy the demo code to a directory for which you have write permission.
   For example:
   $ cp -R demo_module_1  $HOME/XR/demo


2. Create a lib directory that you can use to store shared object libraries 
    
   that you generate from demo code examples, if you have not already done so. 
   For example:
   $ mkdir $HOME/XR/demo/lib

    
3. Create a mibs directory that you can use to store MIB files for the 
   demo code examples, if you have not already done so. 
   For example:
   $ mkdir $HOME/.snmp/mibs


To generate code templates from the sample MIB:


1. Change to the directory where you copied the demo module files. 
   For example:

   $ cd $HOME/XR/demo/demo_module_1
   

2. Copy the SDK-DEMO1-MIB.txt file to the mibs directory you created 
   for the demos.
   For example:
  
   $ cp SDK-DEMO1-MIB.txt $HOME/.snmp/mibs

      
3. Set your MIBS and MIBDIRS environment variables to
   include the appropriate paths.  
   For example, in the csh: 
    
   $ export MIBS=+SDK-DEMO1-MIB ( or $ export MIBS=ALL )
 
4. Run mib2c on the me1LoadGroup group in the SDK-DEMO1-MIB.
   For example:
   
   $ mib2c -c mib2c.scalar.conf me1LoadGroup

   The mib2c utility generates the following template files:
   me1LoadGroup.c 
   me1LoadGroup.h
   

5. Compare the template files with the demo_module_1.c and the
   demo_module_1.h files. 
   
   The demo_module_1 files were created by modifying the templates. 
    

To build the example:

1. Change to the directory where you copied the demo module files. 
   For example:

   $ cd $HOME/XR/demo/demo_module_1
   

2. Use the make command to generate object files.
  
   $ make
    

3. Copy the module shared library object to the lib directory you created. 
   For example:

   $ cp demo_module_1.so $HOME/XR/demo/lib
   
   


   
Setting Up Agent to Run demo_module_1
=============================================
    
1. Edit the agent's configuration file $HOME/.snmp/snmpd.conf,
   and insert a dlmod statement for the module. This statement enables 
   the agent to load the module.
   For example:
   
   dlmod demo_module_1 $HOME/XR/demo/lib/demo_module_1.so
   
    
2. Start the snmp agent. If the agent is already running, stop 
   and restart it in debug mode.
   For example:
   
    $ snmpd -Lo -f -Ddemo_module_1 <port>
    
    The optional -Ddemo_module_1 argument sends debugging statements from 
    demo_module_1. The -Lo option to send debugging statements to the screen 
    instead.



Testing the Module
==================

1. Issue snmpget commands to retrieve scalar data from the module.
   For example:
    
   $ snmpget -v1 -c <community> <host>:<port> SDK-DEMO1-MIB::me1SystemLoadAvg1min.0
   $ snmpget -v1 -c <community> <host>:<port> SDK-DEMO1-MIB::me1SystemLoadAvg5min.0 
   $ snmpget -v1 -c <community> <host>:<port> SDK-DEMO1-MIB::me1SystemLoadAvg15min.0   
   
   Or

   $ snmpget -v1 -c <community> <host>:<port> me1SystemLoadAvg1min.0
   $ snmpget -v1 -c <community> <host>:<port> me1SystemLoadAvg5min.0 
   $ snmpget -v1 -c <community> <host>:<port> me1SystemLoadAvg15min.0   

   Or
   
   $ snmpget -v1 -c <community> <host>:<port> .1.3.6.1.4.1.4242.1.1.1.0
   $ snmpget -v1 -c <community> <host>:<port> .1.3.6.1.4.1.4242.1.1.2.0
   $ snmpget -v1 -c <community> <host>:<port> .1.3.6.1.4.1.4242.1.1.3.0 
      
   Or

   $ snmpwalk -v1 -c <community> <host>:<port> .1.3.6.1.4.1.4242.1.1

   Or
  
   $ snmpwalk -v1 -c <community> <host>:<port> SDK-DEMO1-MIB::me1LoadGroup

   Or
  
   $ snmpwalk -v1 -c <community> <host>:<port> me1LoadGroup

   These commands should produce output similar to the following:
    
    SDK-DEMO1-MIB::me1SystemLoadAvg1min.0 = STRING: 3.906250e-02
    SDK-DEMO1-MIB::me1SystemLoadAvg5min.0 = STRING: 2.734375e-02 
    SDK-DEMO1-MIB::me1SystemLoadAvg15min.0 = STRING: 3.906250e-02 

 
